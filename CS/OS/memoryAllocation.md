## 📌 메모리 할당(Memory Allocation)

### 💡 사전 지식
1. 메모리 영역
- OS 상주 영역과 사용자 프로세스 영역으로 나뉜다.

2. 내부 단편화 외부 단편화
- 내부 단편화(Internal Fragmentation)
    - 프로그램의 크기가 분할의 크기보다 큰 경우
    - 프로그램에 할당된 공간이지만 사용되지 않는 공간

- 외부 단편화(External Fragmentation)
    - 프로그램의 크기보다 분할의 크기가 작은 경우
    - 메모리의 빈 공간이지만 모든 프로그램의 크기보다 작아서 사용되지 못하는 공간
- 두 개념이 어느 정도 연관된 개념이다.
    - 보는 시각의 차이에 따라 외부 단편화가 내부 단편화로 될 수 있음!

3. 홀(hole)
- 가용 메모리 공간이다.
- 메모리는 프로세스에게 적당한 크기(프로세스가 적재될 수 있는)의 홀을 부여한다.
<br>

### ✔️ 사용자 프로세스에 메모리 할당 방법
- 사용자 프로세스에 메모리 할당 방법의 크게 두 가지 방법으로 나뉜다.
- 연속 할당 방법(Contiguous allocation)
    - 각 프로세스를 연속적인 메모리 공간에 적재하는 방법
    - 아래의 두 가지 방법이 존재한다.
        - 고정 분할 할당(Fixed partition allocation)
        - 가변 분할 할당(Variable partition allocation)

- 불연속 할당 방법(Noncontiguous allocation)
    - 하나의 프로세스를 메모리의 여러 영역에 분산시켜 적재하는 방법
    - 아래의 세 가지 방법이 존재한다.
        - 페이징(Paging)
        - 세그멘테이션(Segmentation)
        - 페이지드 세그멘테이션(Paged Segmentation)

### ✔️ 고정 분할 할당
    - 사용자 프로그램이 들어갈 메모리 공간을 미리 분할하는 방법
        - 분할(Partition)의 크기는 각각 다를 수 있다.
        - 분할 당 하나의 프로그램의 적재
    - 사용자 프로세스는 미리 분할된 공간 중 크기가 맞는 메모리 공간에 적재된다.
    - 분할의 개수에 따라 동시에 메모리에 적재되는 프로그램의 수가 제한됨
    - 최대 분할 크기에 따라 최대 프로그램의 크기가 제한됨
    - 내부 단편화와 외부 단편화가 모두 발생
    
### ✔️ 가변 분할 할당
    - 사용자 프로그램이 실행될 때마다 메모리 공간에 차례로 적재하는 방법
    - 분할의 크기와 개수가 동적으로 변함
    - 외부 단편화 발생
        - 메모리에 적재된 프로세스가 종료되면 `홀(hole)`이 생긴다.

### ❗️ 홀(hole) 
- 가용 메모리 공간이다.
- 메모리는 프로세스에게 적당한 크기(프로세스가 적재될 수 있는)의 홀을 부여한다.
- 운영체제는 메모리를 할당 공간과 가용 공간(홀)의 정보를 가지고 있다.

### 동적 메모리 할당 문제(Dynamic Storage-Allocation Problem)
- 가변 분할 방식에서 프로세스가 크기가 n 바이트인 공간이 필요할 때, 가장 적절한 크기의 hole을 찾는 문제
- 일반적으로 세 가지의 방법이 있다.
    - 최초 적합(First-fit)
        - 처음 발견한 크기가 n 바이트 이상의 공간(hole)에 할당

    - 최적 적합(Best-fit)
        - 크기가 n 바이트 이상의 공간 중 가장 작은 공간에 할당
        - 보통 다른 방법에 비해 메모리를 할당한 후 작은 공간이 생긴다.

    - 최작 적합(Worst-fit)
        - 가장 큰 공간에 할당
        - 보통 다른 방법에 비해 메모리를 할당한 후 큰 공간이 생긴다.

- `최초 적합`과 `최적 적합`이 일반적으로 속도와 공간 이용률 측면에서 `최악 적합`보다 효과적인 것으로 알려졌다.
- 공간 효율성 면에서 `최초 적합`과 `최적 적합`은 경우에 따라서 효율적인 방법이 다르다.
- 속도 측면에서는 일반적으로 `최초 적합`이 `최적 적합`보다 더 빠르다.

### 외부 단편화를 해결하기 위한 방법
1. 압축(Compaction) 방법
    - 사용중인 메모리 공간을 한 곳으로 몰고, 다른 한 곳에는 가용 공간(홀)을 모아 큰 홀을 만드는 방법
    - 비용이 많이 드는 작업이며, 메모리 주소를 실행 시간에 동적으로 배치할 수 있을 때 사용 가능한 방법

<br>

### 📚 참고 자료
- [KOCW 운영체제 Ch.Memory Mnagement- 반효경 교수님](http://www.kocw.net/home/search/kemView.do?kemId=1046323)
- Operating System Concepts Ch.8 Main Memory - Abraham Silberschatz 외 2인

<br>

<img alt="크리에이티브 커먼즈 라이선스" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />